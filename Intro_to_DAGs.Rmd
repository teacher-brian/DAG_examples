---
title: "DAG"
author: "Brian Holt"
date: "5/6/2020"
output:
  html_document: null
  pdf_document: default
  toc: yes
  toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#library(tidyverse)
library(here)
library(ggdag)
library(dagitty)
```


```{r}
dag <- dagitty("dag {
  X1 -> X2
  X1 -> Y
  X3 -> X2
  X2 -> Y
  X2 -> T -> Y
  X3 -> T
               }")
plot( graphLayout( dag ) )
```

```{r}
smoking_ca_dag <- dagify(cardiacarrest ~ cholesterol,
       cholesterol ~ smoking + weight,
       smoking ~ unhealthy,
       weight ~ unhealthy,
       labels = c("cardiacarrest" = "Cardiac\n Arrest", 
                  "smoking" = "Smoking",
                  "cholesterol" = "Cholesterol",
                  "unhealthy" = "Unhealthy\n Lifestyle",
                  "weight" = "Weight"),
       latent = "unhealthy",
       exposure = "smoking",
       outcome = "cardiacarrest")

ggdag(smoking_ca_dag, text = FALSE, use_labels = "label")
```




```{r}

layout <- data.frame('x'=seq(1:2),'y'=seq(1,2),
                     'name'= c('family.meals','eatingdis'))
eating_dis_dag <- dagify(eatingdis ~ family.meals,
       labels = c("eatingdis" = 'eating disorder', 
                  "family.meals" = "Family meals"),
       exposure = "family.meals",
       outcome = "eatingdis",
       coords = layout )

ggdag_dseparated(from='family.meals', to='eatingdis', eating_dis_dag, text = FALSE, use_labels = "label")
```

```{r}
dagify(fever ~ flu + pox, 
        acetaminophen ~ fever,
        labels = c("flu" = "Influenza",
                   "pox" = "Chicken Pox",
                   "fever" = "Fever",
                   "acetaminophen" = "Acetaminophen")) %>% 
ggdag_dseparated(from = "flu", to = "pox", controlling_for = "acetaminophen",
                 text = FALSE, use_labels = "label")
```


```{r}
layout <- as.data.frame(matrix(c(seq(1:4), seq(1:4)), ncol = 2))

layout$name <- c("flu", "pox", "fever", "acetaminophen")

colnames(layout)[1:2] <- c("x", "y")

dagify(fever ~ flu + pox,

acetaminophen ~ fever,

labels = c("flu" = "Influenza",

"pox" = "Chicken Pox",

"fever" = "Fever",

"acetaminophen" = "Acetaminophen"),

coords = layout) %>%

ggdag_dseparated(from = "flu", to = "pox", controlling_for = "acetaminophen",

text = FALSE, use_labels = "label")
```



```{r,bayescorona,fig.dim=c(4,3)}
BayesCorona <- dagitty("dag {
  begin -> Virus_0.4
  begin -> NoVirus_99.6
  Virus_0.4 -> TruePos_97
  Virus_0.4 -> FalseNeg
  NoVirus_99.6 -> FalsePos_3
  NoVirus_99.6 -> TrueNeg
               }")
plot( graphLayout( BayesCorona ) )
```